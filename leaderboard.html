<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contributor Points - AnimateItNow</title>
  <link rel="icon" href="favicon.png" type="image/x-icon" />
  <meta name="description" content="A comprehensive collection of CSS animation templates and effects for web developers" />
  <link rel="icon" type="image/png" href="images/logo.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
  
  <style>
    /* CSS Variables for Theming */
    :root {
      --primary: #6c63ff;
      --primary-light: #8a84ff;
      --primary-dark: #554fd8;
      --secondary: #ff6584;
      --accent: #36d1dc;
      --text: #2a2a3c;
      --text-light: #6c757d;
      --bg: #ffffff;
      --bg-secondary: #f8f9fa;
      --bg-tertiary: #e9ecef;
      --border: #dee2e6;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --radius: 12px;
      --transition: all 0.3s ease;
      --header-height: 80px;
    }

    /* Dark Mode Variables */
    .dark-theme {
      --primary: #8a84ff;
      --primary-light: #a8a4ff;
      --primary-dark: #6c63ff;
      --secondary: #ff8fa3;
      --accent: #4dd0e1;
      --text: #f8f9fa;
      --text-light: #a0a0a0;
      --bg: #121212;
      --bg-secondary: #1e1e1e;
      --bg-tertiary: #2a2a2a;
      --border: #404040;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    /* Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', 'Segoe UI', sans-serif;
      line-height: 1.6;
      color: var(--text);
      background-color: var(--bg);
      transition: var(--transition);
      overflow-x: hidden;
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    section {
      padding: 100px 0;
    }

    h1, h2, h3, h4, h5 {
      margin-bottom: 1rem;
      line-height: 1.2;
      font-weight: 700;
    }

    h1 {
      font-size: 3.5rem;
    }

    h2 {
      font-size: 2.5rem;
    }

    h3 {
      font-size: 1.8rem;
    }

    p {
      margin-bottom: 1.5rem;
      color: var(--text-light);
    }

    a {
      text-decoration: none;
      color: inherit;
      transition: var(--transition);
    }

    .btn {
      display: inline-block;
      padding: 14px 32px;
      background-color: var(--primary);
      color: white;
      border-radius: var(--radius);
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: var(--transition);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: var(--transition);
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn:hover {
      background-color: var(--primary-dark);
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(108, 99, 255, 0.3);
    }

    .btn-secondary {
      background-color: var(--secondary);
    }

    .btn-secondary:hover {
      background-color: #e05574;
      box-shadow: 0 10px 20px rgba(255, 101, 132, 0.3);
    }

    .btn-outline {
      background-color: transparent;
      border: 2px solid var(--primary);
      color: var(--primary);
    }

    .btn-outline:hover {
      background-color: var(--primary);
      color: white;
    }

    /* Header/Navigation */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: var(--header-height);
      background-color: var(--bg);
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
      z-index: 999;
      transition: var(--transition);
    }

    .dark-theme .navbar {
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
    }

    .navbar.scrolled {
      height: 70px;
      background-color: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
    }

    .dark-theme .navbar.scrolled {
      background-color: rgba(18, 18, 18, 0.95);
    }

    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 100%;
    }

    .nav-left {
      display: flex;
      align-items: center;
    }

    .logo {
      height: 40px;
      margin-right: 10px;
    }

    .site-name {
      font-size: 1.5rem;
      font-weight: 700;
      background: linear-gradient(to right, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .nav-links {
      display: flex;
      list-style: none;
    }

    .nav-links li {
      margin-left: 30px;
      display: flex;
      align-items: center;
    }

    .nav-links a {
      color: var(--text);
      font-weight: 500;
      position: relative;
      padding: 5px 0;
    }

    .nav-links a::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: 0;
      left: 0;
      background-color: var(--primary);
      transition: var(--transition);
    }

    .nav-links a:hover::after,
    .nav-links a.active::after {
      width: 100%;
    }

    /* Snake cursor toggle */
    .snakeList {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--bg-tertiary);
      transition: var(--transition);
      border-radius: 24px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: var(--transition);
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: var(--primary);
    }

    input:checked + .slider:before {
      transform: translateX(26px);
    }

    .github-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      transition: var(--transition);
    }

    .github-icon:hover {
      background-color: var(--bg-tertiary);
    }

    #theme-toggle {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      color: var(--text);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }

    #theme-toggle:hover {
      background-color: var(--bg-tertiary);
    }

    .hamburger {
      display: none;
      flex-direction: column;
      background: none;
      border: none;
      cursor: pointer;
      width: 30px;
      height: 30px;
      justify-content: center;
      margin-left: 15px;
    }

    .hamburger span {
      width: 25px;
      height: 3px;
      background-color: var(--text);
      margin: 2px 0;
      transition: var(--transition);
      border-radius: 2px;
    }

    /* Leaderboard Styles */
    .leaderboard-main {
      padding-top: var(--header-height);
      min-height: 100vh;
      background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg) 100%);
    }

    .leaderboard-header {
      text-align: center;
      padding: 100px 0 60px;
    }

    .leaderboard-title {
      font-size: 3.5rem;
      margin-bottom: 20px;
      position: relative;
    }

    .leaderboard-title span {
      color: var(--primary);
      position: relative;
    }

    .leaderboard-subtitle {
      font-size: 1.3rem;
      color: var(--text-light);
      max-width: 600px;
      margin: 0 auto;
    }

    /* Stats Section */
    .leaderboard-stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 40px 0;
      flex-wrap: wrap;
    }

    .stat-card {
      background: var(--bg);
      border-radius: var(--radius);
      padding: 25px;
      text-align: center;
      box-shadow: var(--shadow);
      transition: var(--transition);
      border: 1px solid var(--border);
      min-width: 200px;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 10px;
    }

    .stat-label {
      font-size: 1rem;
      color: var(--text-light);
      font-weight: 600;
    }

    /* Search and Filter Section */
    .search-filter-section {
      background: var(--bg);
      border-radius: var(--radius);
      padding: 30px;
      margin: 40px auto;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      max-width: 1000px;
    }

    .search-container {
      display: flex;
      margin-bottom: 30px;
      position: relative;
    }

    .search-input {
      flex: 1;
      padding: 15px 20px;
      font-size: 1.1rem;
      border-radius: var(--radius) 0 0 var(--radius);
      border: 2px solid var(--border);
      background: var(--bg);
      color: var(--text);
      outline: none;
      transition: var(--transition);
    }

    .search-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.1);
    }

    .search-btn {
      padding: 15px 25px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 0 var(--radius) var(--radius) 0;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
    }

    .search-btn:hover {
      background: var(--primary-dark);
    }

    .filter-container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .filter-group {
      flex: 1;
      min-width: 200px;
    }

    .filter-label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      color: var(--text);
    }

    .filter-select {
      width: 100%;
      padding: 12px 15px;
      border-radius: var(--radius);
      border: 2px solid var(--border);
      background: var(--bg);
      color: var(--text);
      cursor: pointer;
      transition: var(--transition);
    }

    .filter-select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.1);
      outline: none;
    }

    /* Table Section */
    .table-section {
      max-width: 1200px;
      margin: 0 auto 60px;
    }

    .table-container {
      background: var(--bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      border: 1px solid var(--border);
    }

    .leaderboard-table {
      width: 100%;
      border-collapse: collapse;
    }

    .leaderboard-table th {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white;
      padding: 20px 15px;
      text-align: left;
      font-weight: 600;
      font-size: 1.1rem;
    }

    .leaderboard-table td {
      padding: 15px;
      border-bottom: 1px solid var(--border);
      transition: var(--transition);
    }

    .leaderboard-table tbody tr:hover {
      background: rgba(108, 99, 255, 0.05);
    }

    .leaderboard-table tbody tr:nth-child(1) {
      background: rgba(255, 215, 0, 0.1);
    }

    .leaderboard-table tbody tr:nth-child(2) {
      background: rgba(192, 192, 192, 0.1);
    }

    .leaderboard-table tbody tr:nth-child(3) {
      background: rgba(205, 127, 50, 0.1);
    }

    .rank-cell {
      text-align: center;
      font-weight: 700;
      font-size: 1.2rem;
    }

    .contributor-cell {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .contributor-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--border);
    }

    .contributor-name {
      font-weight: 600;
      color: var(--text);
    }

    .prs-cell {
      max-width: 400px;
    }

    .pr-summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 10px;
      display: block;
    }

    .pr-list {
      margin: 0;
      padding-left: 20px;
    }

    .pr-list li {
      margin-bottom: 8px;
      font-size: 0.9rem;
    }

    .pr-list a {
      color: var(--primary);
      text-decoration: none;
    }

    .pr-list a:hover {
      text-decoration: underline;
    }

    .points-cell {
      text-align: center;
      font-weight: 700;
      font-size: 1.2rem;
      color: var(--primary);
    }

    /* Pagination */
    .pagination-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin: 40px 0;
    }

    .pagination-btn {
      padding: 12px 20px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
    }

    .pagination-btn:hover:not(:disabled) {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }

    .pagination-btn:disabled {
      background: var(--text-light);
      cursor: not-allowed;
    }

    .pagination-info {
      font-weight: 600;
      color: var(--text);
    }

    /* Download Section */
    .download-section {
      text-align: center;
      margin: 60px 0;
    }

    .download-button {
      background: linear-gradient(135deg, var(--secondary), #ff8fa3);
      color: white;
      padding: 16px 32px;
      border: none;
      margin:25px;
      border-radius: var(--radius);
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 6px 20px rgba(255, 101, 132, 0.2);
    }

    .download-button:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(255, 101, 132, 0.3);
    }

    /* Footer */
    .footer {
      background-color: var(--bg-secondary);
      color: var(--text);
      padding: 60px 0 30px;
      border-top: 1px solid var(--border);
    }

    .footer-content {
      display: flex;
      justify-content: space-between;
      margin-bottom: 40px;
    }

    .footer-left h2 {
      margin-bottom: 15px;
      background: linear-gradient(to right, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .footer-right h4 {
      margin-bottom: 20px;
    }

    .footer-right ul {
      list-style: none;
    }

    .footer-right li {
      margin-bottom: 10px;
    }

    .footer-right a {
      color: var(--text-light);
      transition: var(--transition);
    }

    .footer-right a:hover {
      color: var(--primary);
    }

    .footer-right a i {
      margin-right: 10px;
    }

    .footer-bottom {
      text-align: center;
      padding-top: 30px;
      border-top: 1px solid var(--border);
      color: var(--text-light);
      font-size: 0.9rem;
    }

    .footer-bottom .highlight {
      color: var(--primary);
      font-weight: 600;
    }

    /* Scroll to top button */
    #scrollBtn {
      display: none;
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 99;
      border: none;
      outline: none;
      background-color: var(--primary);
      color: white;
      cursor: pointer;
      padding: 15px;
      border-radius: 50%;
      font-size: 18px;
      width: 50px;
      height: 50px;
      box-shadow: var(--shadow);
      transition: var(--transition);
    }

    #scrollBtn:hover {
      background-color: var(--primary-dark);
      transform: translateY(-3px);
    }

    /* Loading State */
    .loading-state {
      text-align: center;
      padding: 60px 20px;
    }

    .loader {
      border: 6px solid var(--border);
      border-top: 6px solid var(--primary);
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1.2s linear infinite;
      margin: 0 auto 20px;
    }

    .loading-text {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-light);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .leaderboard-title {
        font-size: 2.8rem;
      }
      
      .leaderboard-stats {
        gap: 20px;
      }
      
      .stat-card {
        min-width: 160px;
      }
    }

    @media (max-width: 768px) {
      .nav-links {
        position: fixed;
        top: var(--header-height);
        left: -100%;
        width: 100%;
        height: calc(100vh - var(--header-height));
        background-color: var(--bg);
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        padding-top: 50px;
        transition: left var(--transition);
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        z-index: 998;
      }

      .nav-links.active {
        left: 0;
      }

      .nav-links li {
        margin: 20px 0;
      }

      .nav-links a {
        font-size: 1.1rem;
        padding: 10px 20px;
      }

      .hamburger {
        display: flex;
      }

      .hamburger.active span:nth-child(1) {
        transform: rotate(45deg) translate(5px, 5px);
      }

      .hamburger.active span:nth-child(2) {
        opacity: 0;
      }

      .hamburger.active span:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -6px);
      }
      
      .leaderboard-title {
        font-size: 2.2rem;
      }
      
      .leaderboard-subtitle {
        font-size: 1.1rem;
      }
      
      .search-filter-section {
        padding: 20px;
      }
      
      .search-container {
        flex-direction: column;
      }
      
      .search-input {
        border-radius: var(--radius) var(--radius) 0 0;
      }
      
      .search-btn {
        border-radius: 0 0 var(--radius) var(--radius);
      }
      
      .filter-container {
        flex-direction: column;
        gap: 15px;
      }
      
      .leaderboard-table {
        font-size: 0.9rem;
      }
      
      .leaderboard-table th,
      .leaderboard-table td {
        padding: 12px 8px;
      }
      
      .contributor-avatar {
        width: 40px;
        height: 40px;
      }
    }

    @media (max-width: 576px) {
      .leaderboard-title {
        font-size: 1.8rem;
      }
      
      .leaderboard-stats {
        flex-direction: column;
        align-items: center;
      }
      
      .stat-card {
        width: 100%;
        max-width: 300px;
      }
      
      .leaderboard-table {
        font-size: 0.8rem;
      }
      
      .contributor-cell {
        flex-direction: column;
        text-align: center;
        gap: 8px;
      }
      
      .contributor-avatar {
        width: 35px;
        height: 35px;
      }
    }
  </style>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contributor Points - AnimateItNow</title>
    <link rel="icon" href="favicon.png" type="image/x-icon" />
    <meta name="description"
        content="A comprehensive collection of CSS animation templates and effects for web developers" />
    <link rel="icon" type="image/png" href="images/logo.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

    <style>
        /* CSS Variables for Theming */
        :root {
            --primary: #6c63ff;
            --primary-light: #8a84ff;
            --primary-dark: #554fd8;
            --secondary: #ff6584;
            --accent: #36d1dc;
            --text: #2a2a3c;
            --text-light: #6c757d;
            --bg: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #e9ecef;
            --border: #dee2e6;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --transition: all 0.3s ease;
            --header-height: 80px;
        }

        /* Dark Mode Variables */
        .dark-theme {
            --primary: #8a84ff;
            --primary-light: #a8a4ff;
            --primary-dark: #6c63ff;
            --secondary: #ff8fa3;
            --accent: #4dd0e1;
            --text: #f8f9fa;
            --text-light: #a0a0a0;
            --bg: #121212;
            --bg-secondary: #1e1e1e;
            --bg-tertiary: #2a2a2a;
            --border: #404040;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--bg);
            transition: var(--transition);
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        section {
            padding: 100px 0;
        }

        h1,
        h2,
        h3,
        h4,
        h5 {
            margin-bottom: 1rem;
            line-height: 1.2;
            font-weight: 700;
        }

        h1 {
            font-size: 3.5rem;
        }

        h2 {
            font-size: 2.5rem;
        }

        h3 {
            font-size: 1.8rem;
        }

        p {
            margin-bottom: 1.5rem;
            color: var(--text-light);
        }

        a {
            text-decoration: none;
            color: inherit;
            transition: var(--transition);
        }

        .btn {
            display: inline-block;
            padding: 14px 32px;
            background-color: var(--primary);
            color: white;
            border-radius: var(--radius);
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: var(--transition);
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(108, 99, 255, 0.3);
        }

        .btn-secondary {
            background-color: var(--secondary);
        }

        .btn-secondary:hover {
            background-color: #e05574;
            box-shadow: 0 10px 20px rgba(255, 101, 132, 0.3);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        /* Header/Navigation */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            background-color: var(--bg);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            z-index: 999;
            transition: var(--transition);
        }

        .dark-theme .navbar {
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
        }

        .navbar.scrolled {
            height: 70px;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .dark-theme .navbar.scrolled {
            background-color: rgba(18, 18, 18, 0.95);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
        }

        .nav-left {
            display: flex;
            align-items: center;
        }

        .logo {
            height: 40px;
            margin-right: 10px;
        }

        .site-name {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 30px;
            display: flex;
            align-items: center;
        }

        .nav-links a {
            color: var(--text);
            font-weight: 500;
            position: relative;
            padding: 5px 0;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: var(--primary);
            transition: var(--transition);
        }

        .nav-links a:hover::after,
        .nav-links a.active::after {
            width: 100%;
        }

        /* Snake cursor toggle */
        .snakeList {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-tertiary);
            transition: var(--transition);
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--primary);
        }

        input:checked+.slider:before {
            transform: translateX(26px);
        }

        .github-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .github-icon:hover {
            background-color: var(--bg-tertiary);
        }

        #theme-toggle {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        #theme-toggle:hover {
            background-color: var(--bg-tertiary);
        }

        .hamburger {
            display: none;
            flex-direction: column;
            background: none;
            border: none;
            cursor: pointer;
            width: 30px;
            height: 30px;
            justify-content: center;
            margin-left: 15px;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background-color: var(--text);
            margin: 2px 0;
            transition: var(--transition);
            border-radius: 2px;
        }

        /* Leaderboard Styles */
        .leaderboard-main {
            padding-top: var(--header-height);
            min-height: 100vh;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg) 100%);
        }

        .leaderboard-header {
            text-align: center;
            padding: 100px 0 60px;
        }

        .leaderboard-title {
            font-size: 3.5rem;
            margin-bottom: 20px;
            position: relative;
        }

        .leaderboard-title span {
            color: var(--primary);
            position: relative;
        }

        .leaderboard-subtitle {
            font-size: 1.3rem;
            color: var(--text-light);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Stats Section */
        .leaderboard-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .stat-card {
            background: var(--bg);
            border-radius: var(--radius);
            padding: 25px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--border);
            min-width: 200px;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-light);
            font-weight: 600;
        }

        /* Search and Filter Section */
        .search-filter-section {
            background: var(--bg);
            border-radius: var(--radius);
            padding: 30px;
            margin: 40px auto;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            max-width: 1000px;
        }

        .search-container {
            display: flex;
            margin-bottom: 30px;
            position: relative;
        }

        .search-input {
            flex: 1;
            padding: 15px 20px;
            font-size: 1.1rem;
            border-radius: var(--radius) 0 0 var(--radius);
            border: 2px solid var(--border);
            background: var(--bg);
            color: var(--text);
            outline: none;
            transition: var(--transition);
        }

        .search-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.1);
        }

        .search-btn {
            padding: 15px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 0 var(--radius) var(--radius) 0;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .search-btn:hover {
            background: var(--primary-dark);
        }

        .filter-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text);
        }

        .filter-select {
            width: 100%;
            padding: 12px 15px;
            border-radius: var(--radius);
            border: 2px solid var(--border);
            background: var(--bg);
            color: var(--text);
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.1);
            outline: none;
        }

        /* Table Section */
        .table-section {
            max-width: 1200px;
            margin: 0 auto 60px;
        }

        .table-container {
            background: var(--bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
        }

        .leaderboard-table th {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 20px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .leaderboard-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            transition: var(--transition);
        }

        .leaderboard-table tbody tr:hover {
            background: rgba(108, 99, 255, 0.05);
        }

        .leaderboard-table tbody tr:nth-child(1) {
            background: rgba(255, 215, 0, 0.1);
        }

        .leaderboard-table tbody tr:nth-child(2) {
            background: rgba(192, 192, 192, 0.1);
        }

        .leaderboard-table tbody tr:nth-child(3) {
            background: rgba(205, 127, 50, 0.1);
        }

        .rank-cell {
            text-align: center;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .contributor-cell {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .contributor-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--border);
        }

        .contributor-name {
            font-weight: 600;
            color: var(--text);
        }

        .prs-cell {
            max-width: 400px;
        }

        .pr-summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 10px;
            display: block;
        }

        .pr-list {
            margin: 0;
            padding-left: 20px;
        }

        .pr-list li {
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .pr-list a {
            color: var(--primary);
            text-decoration: none;
        }

        .pr-list a:hover {
            text-decoration: underline;
        }

        .points-cell {
            text-align: center;
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--primary);
        }

        /* Pagination */
        .pagination-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 40px 0;
        }

        .pagination-btn {
            padding: 12px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .pagination-btn:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .pagination-btn:disabled {
            background: var(--text-light);
            cursor: not-allowed;
        }

        .pagination-info {
            font-weight: 600;
            color: var(--text);
        }

        /* Download Section */
        .download-section {
            text-align: center;
            margin: 60px 0;
        }

        .download-button {
            background: linear-gradient(135deg, var(--secondary), #ff8fa3);
            color: white;
            padding: 16px 32px;
            border: none;
            border-radius: var(--radius);
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 6px 20px rgba(255, 101, 132, 0.2);
        }

        .download-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(255, 101, 132, 0.3);
        }

        /* Footer */
        .footer {
            background-color: var(--bg-secondary);
            color: var(--text);
            padding: 60px 0 30px;
            border-top: 1px solid var(--border);
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
        }

        .footer-left h2 {
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .footer-right h4 {
            margin-bottom: 20px;
        }

        .footer-right ul {
            list-style: none;
        }

        .footer-right li {
            margin-bottom: 10px;
        }

        .footer-right a {
            color: var(--text-light);
            transition: var(--transition);
        }

        .footer-right a:hover {
            color: var(--primary);
        }

        .footer-right a i {
            margin-right: 10px;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid var(--border);
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .footer-bottom .highlight {
            color: var(--primary);
            font-weight: 600;
        }

        /* Scroll to top button */
        #scrollBtn {
            display: none;
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 99;
            border: none;
            outline: none;
            background-color: var(--primary);
            color: white;
            cursor: pointer;
            padding: 15px;
            border-radius: 50%;
            font-size: 18px;
            width: 50px;
            height: 50px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        #scrollBtn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
        }

        /* Loading State */
        .loading-state {
            text-align: center;
            padding: 60px 20px;
        }

        .loader {
            border: 6px solid var(--border);
            border-top: 6px solid var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1.2s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-light);
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .leaderboard-title {
                font-size: 2.8rem;
            }

            .leaderboard-stats {
                gap: 20px;
            }

            .stat-card {
                min-width: 160px;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                position: fixed;
                top: var(--header-height);
                left: -100%;
                width: 100%;
                height: calc(100vh - var(--header-height));
                background-color: var(--bg);
                flex-direction: column;
                justify-content: flex-start;
                align-items: center;
                padding-top: 50px;
                transition: left var(--transition);
                box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
                z-index: 998;
            }

            .nav-links.active {
                left: 0;
            }

            .nav-links li {
                margin: 20px 0;
            }

            .nav-links a {
                font-size: 1.1rem;
                padding: 10px 20px;
            }

            .hamburger {
                display: flex;
            }

            .hamburger.active span:nth-child(1) {
                transform: rotate(45deg) translate(5px, 5px);
            }

            .hamburger.active span:nth-child(2) {
                opacity: 0;
            }

            .hamburger.active span:nth-child(3) {
                transform: rotate(-45deg) translate(7px, -6px);
            }

            .leaderboard-title {
                font-size: 2.2rem;
            }

            .leaderboard-subtitle {
                font-size: 1.1rem;
            }

            .search-filter-section {
                padding: 20px;
            }

            .search-container {
                flex-direction: column;
            }

            .search-input {
                border-radius: var(--radius) var(--radius) 0 0;
            }

            .search-btn {
                border-radius: 0 0 var(--radius) var(--radius);
            }

            .filter-container {
                flex-direction: column;
                gap: 15px;
            }

            .leaderboard-table {
                font-size: 0.9rem;
            }

            .leaderboard-table th,
            .leaderboard-table td {
                padding: 12px 8px;
            }

            .contributor-avatar {
                width: 40px;
                height: 40px;
            }
        }

        @media (max-width: 576px) {
            .leaderboard-title {
                font-size: 1.8rem;
            }

            .leaderboard-stats {
                flex-direction: column;
                align-items: center;
            }

            .stat-card {
                width: 100%;
                max-width: 300px;
            }

            .leaderboard-table {
                font-size: 0.8rem;
            }

            .contributor-cell {
                flex-direction: column;
                text-align: center;
                gap: 8px;
            }

            .contributor-avatar {
                width: 35px;
                height: 35px;
            }
        }
    </style>
    <link rel="stylesheet" href="./navbar_styles.css">
</head>

<body>
    <!-- Navigation -->
    <div id="navbar"></div>

  <script>
    fetch('nav.html')
      .then(res => res.text())
      .then(data => {
        document.getElementById('navbar').innerHTML = data;
        // Load the navbar theme manager script
        const script = document.createElement('script');
        script.src = 'navbar-theme.js';
        script.onload = () => {
          console.log('Navbar theme manager loaded successfully');
        };
        document.head.appendChild(script);
      })
      .catch(err => console.error('Error loading navbar:', err));
  </script>

    <!-- Leaderboard Main Content -->
    <main class="leaderboard-main">
        <section class="leaderboard-header">
            <div class="container">
                <h1 class="leaderboard-title">
                    Contributor <span>Leaderboard</span>
                </h1>
                <p class="leaderboard-subtitle">
                    Track contributions and celebrate our amazing community members
                </p>
            </div>
        </section>

        <section class="container">
            <!-- Stats Section -->
            <div class="leaderboard-stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalContributors">0</div>
                    <div class="stat-label">Contributors</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalPRs">0</div>
                    <div class="stat-label">Total Contributions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalPoints">0</div>
                    <div class="stat-label">Total Points</div>
                </div>
            </div>


            <!-- Search and Filter Section -->
            <div class="search-filter-section">
                <div class="search-container">
                    <input type="text" id="searchUser" class="search-input" placeholder="Search contributors..." />
                    <button id="searchBtn" class="search-btn">
                        Search
                    </button>
                </div>

                <div class="filter-container">
                    <div class="filter-group">
                        <label class="filter-label">Time Period</label>
                        <select id="timeFilter" class="filter-select">
                            <option value="all">All Time</option>
                            <option value="week1">Week 1</option>
                            <option value="week2">Week 2</option>
                            <option value="week3">Week 3</option>
                            <option value="week4">Week 4</option>
                            <option value="month">This Month</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Sort By</label>
                        <select id="sortFilter" class="filter-select">
                            <option value="points">Points (High to Low)</option>
                            <option value="name">Name (A to Z)</option>
                            <option value="prs">PR Count (High to Low)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Table Section -->
            <div class="table-section">
                <div class="table-container">
                    <table id="pointsTable" class="leaderboard-table">
                        <thead>
                            <tr>
                                <th style="width: 10%;">Rank</th>
                                <th style="width: 25%;">Contributor</th>
                                <th style="width: 45%;">Contributions</th>
                                <th style="width: 20%;">Points</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="4" class="loading-state">
                                    <div class="loader"></div>
                                    <p class="loading-text">Fetching data from GitHub...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div id="pagination" class="pagination-container"></div>
            </div>



            <!-- Download Section -->
            <div class="download-section">
                <button class="download-button" onclick="downloadExcel()">
                    <i class="fas fa-download"></i> Download as Excel
                </button>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <h2>AnimateItNow</h2>
                    <p>Creating impactful web animations and templates for everyone.</p>
                </div>
                <div class="footer-right">
                    <h4>Connect With Us</h4>
                    <ul>
                        <li><a href="https://github.com/itsAnimation/AnimateItNow" target="_blank"
                                rel="noopener noreferrer"><i class="fab fa-github"></i> GitHub</a></li>
                        <li><a href="https://www.linkedin.com/in/anujshrivastava1/" target="_blank"
                                rel="noopener noreferrer"><i class="fab fa-linkedin"></i> LinkedIn</a></li>
                        <li><a href="mailto:contact@animateitnow.com" rel="noopener noreferrer"><i
                                    class="fas fa-envelope"></i> Email Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>© 2025 AnimateItNow. Made with ❤️ by <span class="highlight">Anuj</span> and Contributors.</p>
            </div>
        </div>
    </footer>

    <!-- Scroll to top button -->
    <button onclick="scrollToTop()" id="scrollBtn" title="Go to top">↑</button>

    <script>
        // Enhanced leaderboard JavaScript
        const owner = "itsAnimation";
        const repo = "AnimateItNow";
        let token = "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"; // GitHub Personal Access Token
        const pointsPerLevel = {
            "level1": 3,
            "level2": 7,
            "level3": 10,
            "good first issue": 2,
            "bug": 5,
            "enhancement": 8,
            "documentation": 4,
            "hacktoberfest": 3
        };
        let contributorsData = [];
        let allPRsData = [];
        let currentPage = 1;
        const perPage = 10;
        let currentFilter = 'all';
        let currentSort = 'points';
        let filteredData = null;

        // Theme toggle and mobile navigation are now handled by navbar-theme.js


        // Scroll to top functionality
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        window.onscroll = function () {
            const scrollBtn = document.getElementById("scrollBtn");
            if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                scrollBtn.style.display = "block";
            } else {
                scrollBtn.style.display = "none";
            }
        };

        // Fetch merged PRs with enhanced error handling and rate limit management
        async function fetchMergedPRs(page = 1, allPRs = []) {
            try {
                const url = `https://api.github.com/repos/${owner}/${repo}/pulls?state=closed&per_page=100&page=${page}&sort=updated&direction=desc`;
                const headers = {
                    'Accept': 'application/vnd.github.v3+json',
                    'User-Agent': 'AnimateItNow-Leaderboard'
                };
                
                if (token) {
                    headers['Authorization'] = `token ${token}`;
                }

                const res = await fetch(url, { headers });

                // Handle rate limiting
                if (res.status === 403) {
                    const rateLimitRemaining = res.headers.get('X-RateLimit-Remaining');
                    const rateLimitReset = res.headers.get('X-RateLimit-Reset');
                    if (rateLimitRemaining === '0') {
                        const resetTime = new Date(parseInt(rateLimitReset) * 1000);
                        throw new Error(`GitHub API rate limit exceeded. Reset at: ${resetTime.toLocaleTimeString()}`);
                    }
                }

                if (!res.ok) {
                    const errorText = await res.text();
                    throw new Error(`GitHub API error! Status: ${res.status}. Message: ${errorText}`);
                }

                const prs = await res.json();
                if (!Array.isArray(prs)) return allPRs;

                const merged = prs.filter(pr => pr.merged_at && pr.user && pr.user.login);
                allPRs = allPRs.concat(merged);

                // Also fetch issues that were closed and might have points
                if (page === 1) {
                    try {
                        const issuesUrl = `https://api.github.com/repos/${owner}/${repo}/issues?state=closed&per_page=100&page=${page}&sort=updated&direction=desc`;
                        const issuesRes = await fetch(issuesUrl, { headers });
                        if (issuesRes.ok) {
                            const issues = await issuesRes.json();
                            const closedIssues = issues.filter(issue => 
                                issue.pull_request === undefined && 
                                issue.user && 
                                issue.user.login
                            );
                            allPRs = allPRs.concat(closedIssues);
                        }
                    } catch (issueError) {
                        console.warn('Could not fetch issues:', issueError);
                    }
                }

                if (prs.length === 100) {
                    return fetchMergedPRs(page + 1, allPRs);
                } else {
                    return allPRs;
                }
            } catch (error) {
                console.error('Error fetching PRs:', error);
                throw error;
            }
        }

        // Calculate contributor data from PRs and Issues
        function calculateContributorData(contributions) {
            const data = {};
            contributions.forEach(contribution => {
                const user = contribution.user.login;
                const avatar = contribution.user.avatar_url;
                const url = contribution.html_url;
                const title = contribution.title;
                const labels = contribution.labels ? contribution.labels.map(label => label.name.toLowerCase()) : [];
                
                // Determine contribution type and points
                let points = 0;
                let contributionType = 'unknown';
                
                // Check for level labels first
                const levelLabel = labels.find(l => l.startsWith("level"));
                if (levelLabel) {
                    points = pointsPerLevel[levelLabel] || 0;
                    contributionType = levelLabel;
                } else {
                    // Check for other label types
                    const matchedLabel = labels.find(l => pointsPerLevel[l]);
                    if (matchedLabel) {
                        points = pointsPerLevel[matchedLabel];
                        contributionType = matchedLabel;
                    } else {
                        // Default points based on contribution type
                        if (contribution.pull_request) {
                            // It's a PR
                            points = 5; // Default PR points
                            contributionType = 'pull_request';
                        } else {
                            // It's an issue
                            points = 2; // Default issue points
                            contributionType = 'issue';
                        }
                    }
                }

                // Skip if no points assigned
                if (points === 0) return;

                if (!data[user]) {
                    data[user] = { contributions: [], total: 0, avatar };
                }
                
                data[user].contributions.push({ 
                    title, 
                    url, 
                    type: contributionType,
                    points,
                    labels,
                    created_at: contribution.created_at,
                    merged_at: contribution.merged_at || contribution.closed_at
                });
                data[user].total += points;
            });
            return data;
        }

        // Function to update stats
        function updateStats() {
            const dataToShow = filteredData || contributorsData;

            // Total contributors
            const totalContributors = dataToShow.length;
            document.getElementById('totalContributors').textContent = totalContributors;

            // Total contributions (PRs + Issues)
            let totalContributions = 0;
            dataToShow.forEach(([user, userData]) => {
                totalContributions += userData.contributions.length;
            });
            document.getElementById('totalPRs').textContent = totalContributions;

            // Total points
            let totalPoints = 0;
            dataToShow.forEach(([user, userData]) => {
                totalPoints += userData.total;
            });
            document.getElementById('totalPoints').textContent = totalPoints;
        }

        // Render table page with proper styling
        function renderTablePage(page) {
            const tbody = document.querySelector("#pointsTable tbody");
            tbody.innerHTML = "";

            // Determine which data to show: search filtered or original
            let dataToShow = contributorsData;
            if (filteredData) {
                dataToShow = filteredData;
            }

            // Apply sorting
            dataToShow = [...dataToShow]; // Create a copy to avoid mutating original
            if (currentSort === 'points') {
                dataToShow.sort((a, b) => b[1].total - a[1].total);
            } else if (currentSort === 'name') {
                dataToShow.sort((a, b) => a[0].localeCompare(b[0]));
            } else if (currentSort === 'prs') {
                dataToShow.sort((a, b) => b[1].prs.length - a[1].prs.length);
            }

            const startIdx = (page - 1) * perPage;
            const endIdx = startIdx + perPage;
            const pageData = dataToShow.slice(startIdx, endIdx);

            if (pageData.length === 0) {
                tbody.innerHTML = `
          <tr>
            <td colspan="4" style="text-align: center; padding: 40px;">
              No contributors found matching your criteria.
            </td>
          </tr>
        `;
                return;
            }

            pageData.forEach(([user, userData], idx) => {
                const row = document.createElement("tr");
                const actualRank = startIdx + idx + 1;

                // Rank cell
                const rankTd = document.createElement("td");
                rankTd.className = "rank-cell";
                if (actualRank === 1) {
                    rankTd.innerHTML = `<span style="color: gold;">🥇</span> ${actualRank}`;
                } else if (actualRank === 2) {
                    rankTd.innerHTML = `<span style="color: silver;">🥈</span> ${actualRank}`;
                } else if (actualRank === 3) {
                    rankTd.innerHTML = `<span style="color: #cd7f32;">🥉</span> ${actualRank}`;
                } else {
                    rankTd.textContent = actualRank;
                }

                row.appendChild(rankTd);

                // Contributor cell
                const contributorTd = document.createElement("td");
                contributorTd.className = "contributor-cell";
                contributorTd.innerHTML = `
          <img class="contributor-avatar" src="${userData.avatar}" alt="${user}'s avatar">
          <span class="contributor-name">${user}</span>
        `;
                row.appendChild(contributorTd);

                // Contributions cell
                const contributionsTd = document.createElement("td");
                contributionsTd.className = "prs-cell";

                const contributionListHtml = userData.contributions.map(contrib => {
                    const typeIcon = contrib.type === 'pull_request' ? '🔀' : 
                                   contrib.type === 'issue' ? '📋' : '🏷️';
                    return `<li><a href="${contrib.url}" target="_blank">${typeIcon} ${contrib.title}</a> - <strong>${contrib.type} = ${contrib.points} points</strong></li>`;
                }).join("");

                contributionsTd.innerHTML = `
          <details>
            <summary class="pr-summary">Show Contributions (${userData.contributions.length})</summary>
            <ul class="pr-list">${contributionListHtml}</ul>
          </details>
        `;
                row.appendChild(contributionsTd);

                // Points cell
                const pointsTd = document.createElement("td");
                pointsTd.className = "points-cell";
                pointsTd.textContent = userData.total;
                row.appendChild(pointsTd);

                tbody.appendChild(row);
            });

            renderPagination(dataToShow.length);
            updateStats();
        }


        // Render pagination controls
        function renderPagination(totalItems) {
            const totalPages = Math.ceil(totalItems / perPage);
            const pagination = document.getElementById("pagination");
            pagination.innerHTML = "";

            if (totalPages <= 1) return;

            const prevBtn = document.createElement("button");
            prevBtn.textContent = "← Previous";
            prevBtn.className = "pagination-btn";
            prevBtn.disabled = currentPage === 1;
            prevBtn.onclick = () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderTablePage(currentPage);
                }
            };

            const nextBtn = document.createElement("button");
            nextBtn.textContent = "Next →";
            nextBtn.className = "pagination-btn";
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.onclick = () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderTablePage(currentPage);
                }
            };

            const pageInfo = document.createElement("span");
            pageInfo.className = "pagination-info";
            pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;

            pagination.appendChild(prevBtn);
            pagination.appendChild(pageInfo);
            pagination.appendChild(nextBtn);
        }

        // Search functionality
        document.addEventListener('DOMContentLoaded', function () {
            const searchBtn = document.getElementById('searchBtn');
            const searchInput = document.getElementById('searchUser');
            const timeFilter = document.getElementById('timeFilter');
            const sortFilter = document.getElementById('sortFilter');

            function performSearch() {
                const val = searchInput.value.trim().toLowerCase();
                if (!val) {
                    filteredData = null;
                } else {
                    filteredData = contributorsData.filter(([user]) => user.toLowerCase().includes(val));
                }
                currentPage = 1;
                renderTablePage(currentPage);
            }

            if (searchBtn && searchInput) {
                searchBtn.addEventListener('click', performSearch);

                searchInput.addEventListener('keydown', function (e) {
                    if (e.key === 'Enter') {
                        performSearch();
                    }
                });

                // Clear search on escape key
                searchInput.addEventListener('keydown', function (e) {
                    if (e.key === 'Escape') {
                        searchInput.value = '';
                        performSearch();
                    }
                });
            }

            // Filter functionality
            if (timeFilter) {
                timeFilter.addEventListener('change', function () {
                    currentFilter = this.value;
                    // In a real implementation, you would filter by time period here
                    currentPage = 1;
                    renderTablePage(currentPage);
                });
            }

            // Sort functionality
            if (sortFilter) {
                sortFilter.addEventListener('change', function () {
                    currentSort = this.value;
                    currentPage = 1;
                    renderTablePage(currentPage);
                });
            }
        });


        // Download Excel functionality
        function downloadExcel() {
            const table = document.createElement("table");
            table.innerHTML = `
        <thead>
          <tr>
            <th>Rank</th>
            <th>Contributor</th>
            <th>Contributions</th>
            <th>Total Points</th>
          </tr>
        </thead>
        <tbody></tbody>
      `;

            const tbody = table.querySelector("tbody");

            // Use the currently displayed data (filtered or original)
            let dataToExport = contributorsData;
            if (filteredData) {
                dataToExport = filteredData;
            }

            dataToExport.forEach(([user, userData], idx) => {
                const contributionList = userData.contributions.map(contrib => {
                    const typeIcon = contrib.type === 'pull_request' ? 'PR' : 
                                   contrib.type === 'issue' ? 'Issue' : contrib.type;
                    return `${contrib.title} (${typeIcon} = ${contrib.points} points)`;
                }).join('; ');

                const row = document.createElement("tr");
                row.innerHTML = `
          <td>${idx + 1}</td>
          <td>${user}</td>
          <td>${contributionList}</td>
          <td>${userData.total}</td>
        `;
                tbody.appendChild(row);
            });

            const wb = XLSX.utils.table_to_book(table, { sheet: "Contributor Points" });
            XLSX.writeFile(wb, "AnimateItnow_Contributors.xlsx");
        }

        // Initialize leaderboard with enhanced error handling
        async function init() {
            try {
                console.log('Starting to fetch GitHub data...');
                const contributions = await fetchMergedPRs();
                allPRsData = contributions;
                let fetchedContributors = Object.entries(calculateContributorData(contributions)).sort((a, b) => b[1].total - a[1].total);

                console.log('Fetched contributors:', fetchedContributors.length);
                console.log('Total contributions:', contributions.length);

                // If no data fetched, show a helpful message
                if (fetchedContributors.length === 0) {
                    console.warn("No contributor data found. This might be due to:");
                    console.warn("1. No merged PRs or closed issues in the repository");
                    console.warn("2. GitHub API rate limiting");
                    console.warn("3. Repository not found or private");
                    
                    // Show message in table
                    const tbody = document.querySelector("#pointsTable tbody");
                    tbody.innerHTML = `
          <tr>
            <td colspan="4" style="text-align: center; padding: 40px;">
              <div style="font-size: 3rem; margin-bottom: 20px;">📊</div>
              <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px; color: var(--primary);">
                No Contributions Found
              </div>
              <div style="font-size: 0.9rem; color: var(--text-light); margin-bottom: 20px;">
                No merged pull requests or closed issues found in the repository.<br>
                Start contributing to see your name on the leaderboard!
              </div>
              <a href="https://github.com/${owner}/${repo}" target="_blank" style="padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; text-decoration: none; display: inline-block;">
                View Repository
              </a>
            </td>
          </tr>
        `;
                    return;
                }

                contributorsData = fetchedContributors;
                currentPage = 1;
                renderTablePage(currentPage);

            } catch (error) {
                console.error('Error loading leaderboard data:', error);

                // Display error message in table
                const tbody = document.querySelector("#pointsTable tbody");
                tbody.innerHTML = `
          <tr>
            <td colspan="4" style="text-align: center; padding: 40px;">
              <div style="font-size: 3rem; margin-bottom: 20px;">⚠️</div>
              <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px; color: #dc3545;">
                Error Loading Data
              </div>
              <div style="font-size: 0.9rem; color: #666; margin-bottom: 20px;">
                ${error.message.includes('rate limit') ? 
                  'GitHub API rate limit exceeded. Please try again later.' :
                  'Unable to fetch contributor data. This might be due to network issues or repository access.'}
              </div>
              <div style="margin-bottom: 20px;">
                <button onclick="location.reload()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; margin-right: 10px;">
                Retry
              </button>
                <a href="https://github.com/${owner}/${repo}" target="_blank" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; text-decoration: none; display: inline-block;">
                  View Repository
                </a>
              </div>
            </td>
          </tr>
        `;
            }
        }

        // Start initialization after DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
        init();
        });
    </script>
</body>

</html>